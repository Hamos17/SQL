-- 지불유형(PAY_TP)별 주문건수(주문 건수를 주문년월별로 컬럼으로 표시) - 인라인 뷰 활용
SELECT T1.PAY_TP
	   , MAX(CASE WHEN T1.ORD_YM = '201701' THEN T1.ORD_CNT END) AS ORD_CNT_1701
	   , MAX(CASE WHEN T1.ORD_YM = '201702' THEN T1.ORD_CNT END) AS ORD_CNT_1702
	   , MAX(CASE WHEN T1.ORD_YM = '201703' THEN T1.ORD_CNT END) AS ORD_CNT_1703
	   , MAX(CASE WHEN T1.ORD_YM = '201704' THEN T1.ORD_CNT END) AS ORD_CNT_1704
	   , MAX(CASE WHEN T1.ORD_YM = '201705' THEN T1.ORD_CNT END) AS ORD_CNT_1705
	   , MAX(CASE WHEN T1.ORD_YM = '201706' THEN T1.ORD_CNT END) AS ORD_CNT_1706
	   , MAX(CASE WHEN T1.ORD_YM = '201707' THEN T1.ORD_CNT END) AS ORD_CNT_1707
	   , MAX(CASE WHEN T1.ORD_YM = '201708' THEN T1.ORD_CNT END) AS ORD_CNT_1708
	   , MAX(CASE WHEN T1.ORD_YM = '201709' THEN T1.ORD_CNT END) AS ORD_CNT_1709
	   , MAX(CASE WHEN T1.ORD_YM = '201710' THEN T1.ORD_CNT END) AS ORD_CNT_1710
	   , MAX(CASE WHEN T1.ORD_YM = '201711' THEN T1.ORD_CNT END) AS ORD_CNT_1711
	   , MAX(CASE WHEN T1.ORD_YM = '201712' THEN T1.ORD_CNT END) AS ORD_CNT_1712
FROM   (
			 SELECT T1.PAY_TP
			 	    , TO_CHAR(T1.ORD_DT, 'YYYYMM') AS ORD_YM
			 	    , COUNT(*)					    AS ORD_CNT
			 FROM   T_ORD T1
			 WHERE  1 = 1
			 AND    T1.ORD_ST = 'COMP'
			 GROUP BY T1.PAY_TP, TO_CHAR(T1.ORD_DT, 'YYYYMM')
		 ) T1
GROUP BY T1.PAY_TP;